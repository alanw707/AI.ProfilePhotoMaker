<div class="dashboard-container">
  <!-- Shared Header Navigation -->
  <app-header-navigation></app-header-navigation>

  <!-- Main Dashboard Content -->
  <main class="dashboard-main">
    <div class="dashboard-content">
      
      <!-- Quick Stats -->
      <section class="stats-section">
        <div class="stats-grid">
          <app-stats-card 
            icon="üì∏" 
            [value]="uploadedImages" 
            label="Selfies Uploaded">
          </app-stats-card>
          <app-stats-card 
            icon="‚ö°" 
            [value]="generatedPhotos.length" 
            label="Photos Generated">
          </app-stats-card>
          <app-stats-card 
            icon="ü§ñ" 
            [value]="modelStatus" 
            label="Model Status"
            [isModelStatus]="true">
          </app-stats-card>
          <app-stats-card 
            icon="üíé" 
            [value]="getTotalAvailableCredits()" 
            label="Credits"
            [showCard]="!!(creditsInfo || userCreditStatus)"
            [showSettingsHint]="true">
          </app-stats-card>
        </div>
      </section>


      <!-- No Package - Get Started Section -->
      <section class="get-started-section" *ngIf="!isPremiumWorkflow()">
        <div class="get-started-card">
          <div class="get-started-header">
            <h2>Welcome to AI Profile Photo Maker</h2>
            <p>Create stunning, professional AI-generated profile photos with our advanced technology</p>
          </div>
          
          <div class="options-grid">
            <div class="option-card premium-option">
              <div class="option-header">
                <div class="option-icon">üéØ</div>
                <h3>Premium Studio</h3>
              </div>
              <div class="option-content">
                <ul>
                  <li>‚ú® Train your own custom AI model</li>
                  <li>üé® Generate photos in multiple professional styles</li>
                  <li>üì∏ Create 5-50 high-quality photos</li>
                  <li>üîí Complete data control with account settings</li>
                </ul>
                <button class="btn btn-primary" routerLink="/packages">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <path d="M12 2L3.09 8.26L12 22L20.91 8.26L12 2Z" stroke="currentColor" stroke-width="2" fill="none"/>
                  </svg>
                  View Packages
                </button>
              </div>
            </div>
            
            <div class="option-card basic-option">
              <div class="option-header">
                <div class="option-icon">‚ö°</div>
                <h3>Basic Enhancement</h3>
              </div>
              <div class="option-content">
                <ul>
                  <li>üñºÔ∏è Background removal & replacement</li>
                  <li>‚ú® Professional lighting & styling</li>
                  <li>üì± Social media optimized photos</li>
                  <li>üé® Creative cartoon transformations</li>
                </ul>
                <button class="btn btn-secondary" routerLink="/enhance">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
                    <path d="M12 1v6m0 6v6m11-7h-6m-6 0H1" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  Enhance Photos
                </button>
              </div>
            </div>
          </div>
          
          <div class="credits-display" *ngIf="creditsInfo">
            <div class="credits-info-card">
              <div class="credits-icon">‚ö°</div>
              <div class="credits-text">
                <span class="credits-count">{{creditsInfo.availableCredits}} Free Credits</span>
                <span class="credits-note">Use for basic photo enhancement</span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Workflow Steps -->
      <section class="workflow-section" *ngIf="isPremiumWorkflow()">
        <h2>Create Your Professional Photos</h2>
        <p class="workflow-subtitle">Follow these simple steps to generate stunning AI-powered profile photos</p>
        
        <div class="workflow-steps">
          
          <!-- Step 1: Upload Selfies -->
          <div class="step-card" [class.completed]="uploadedImages > 0 || uploadedImageThumbnails.length > 0" [class.active]="currentStep === 1">
            <div class="step-header">
              <div class="step-number">1</div>
              <div class="step-title">
                <h3>Upload Your Selfies</h3>
                <p>Upload at least 10 high-quality selfies for the best results</p>
              </div>
              <div class="step-status">
                <span class="status-badge" [ngClass]="getStepStatus(1)">
                  {{getStepStatusText(1)}}
                </span>
              </div>
            </div>
            <div class="step-content" *ngIf="currentStep === 1 || uploadedImages === 0 || uploadedImageThumbnails.length > 0">
              <!-- Hidden file input - always available for Upload More Images button -->
              <input type="file" #fileInput multiple accept="image/*" (change)="onFileSelected($event)" style="display: none">
              
              <!-- Upload Guidelines (always shown for reference) -->
              <div class="upload-guidelines">
                <div class="guidelines-header">
                  <div class="guidelines-icon">üìù</div>
                  <h4>Image Quality Guidelines</h4>
                  <p>Follow these guidelines to ensure your photos pass our quality checks</p>
                </div>
                
                <div class="guidelines-grid">
                  <!-- Good Examples Column -->
                  <div class="guidelines-column good-examples">
                    <h5 class="column-title">‚úÖ Good Examples</h5>
                    <div class="guideline-item good">
                      <span class="guideline-icon">‚úÖ</span>
                      <span class="guideline-text">Use shoulders-up images</span>
                    </div>
                    <div class="guideline-item good">
                      <span class="guideline-icon">‚úÖ</span>
                      <span class="guideline-text">Waist-up images are also good</span>
                    </div>
                    <div class="guideline-item good">
                      <span class="guideline-icon">‚úÖ</span>
                      <span class="guideline-text">Some background space around your head</span>
                    </div>
                    <div class="guideline-item good">
                      <span class="guideline-icon">‚úÖ</span>
                      <span class="guideline-text">Looking at the camera</span>
                    </div>
                    <div class="guideline-item good">
                      <span class="guideline-icon">‚úÖ</span>
                      <span class="guideline-text">Good lighting and sharp focus</span>
                    </div>
                    <div class="guideline-item good">
                      <span class="guideline-icon">‚úÖ</span>
                      <span class="guideline-text">High resolution (1024x1024+ for best results)</span>
                    </div>
                  </div>

                  <!-- Bad Examples Column -->
                  <div class="guidelines-column bad-examples">
                    <h5 class="column-title">‚ùå Bad Examples</h5>
                    <div class="guideline-item bad">
                      <span class="guideline-icon">‚ùå</span>
                      <span class="guideline-text">Extra people in photo</span>
                    </div>
                    <div class="guideline-item bad">
                      <span class="guideline-icon">‚ùå</span>
                      <span class="guideline-text">Multiple photos same day</span>
                    </div>
                    <div class="guideline-item bad">
                      <span class="guideline-icon">‚ùå</span>
                      <span class="guideline-text">Funny faces or expressions</span>
                    </div>
                    <div class="guideline-item bad">
                      <span class="guideline-icon">‚ùå</span>
                      <span class="guideline-text">Filters, B&W or Sepia</span>
                    </div>
                    <div class="guideline-item bad">
                      <span class="guideline-icon">‚ùå</span>
                      <span class="guideline-text">Bad lighting, low quality, blurry</span>
                    </div>
                    <div class="guideline-item bad">
                      <span class="guideline-icon">‚ùå</span>
                      <span class="guideline-text">Hats, glasses, or face coverings</span>
                    </div>
                    <div class="guideline-item bad">
                      <span class="guideline-icon">‚ùå</span>
                      <span class="guideline-text">Extreme close-ups or tightly cropped</span>
                    </div>
                  </div>
                </div>

                <!-- Additional Info -->
                <div class="guidelines-footer">
                  <div class="guideline-item info">
                    <span class="guideline-icon">üìÅ</span>
                    <span class="guideline-text">File Requirements: JPEG/PNG ‚Ä¢ Max 7MB ‚Ä¢ 512x512+ pixels ‚Ä¢ 10-20 photos recommended</span>
                  </div>
                  <div class="guideline-item info">
                    <span class="guideline-icon">üóÇÔ∏è</span>
                    <span class="guideline-text">Data Retention: Input photos 7 days ‚Ä¢ Generated photos 30 days</span>
                  </div>
                </div>
              </div>

              <!-- Upload area for new images -->
              <div class="upload-area" 
                   *ngIf="selectedFiles.length === 0"
                   (click)="triggerFileUpload()"
                   (dragover)="onDragOver($event)"
                   (dragleave)="onDragLeave($event)"
                   (drop)="onDrop($event)"
                   [class.drag-over]="isDragOver">
                <div class="upload-icon">üì∑</div>
                <h4>Drop your selfies here or click to browse</h4>
                <p>Maximum 20 images ‚Ä¢ JPG, PNG, WebP ‚Ä¢ Up to 7MB each</p>
              </div>

              <!-- Show uploaded image thumbnails (completed work) -->
              <div class="uploaded-thumbnails" *ngIf="uploadedImageThumbnails.length > 0">
                <h4>Uploaded Images ({{uploadedImageThumbnails.length}})</h4>
                <div class="thumbnail-grid">
                  <div class="thumbnail-item" *ngFor="let thumb of uploadedImageThumbnails; index as i">
                    <img [src]="thumb.url" [alt]="thumb.fileName">
                    <button class="delete-thumbnail-btn" 
                            (click)="deleteUploadedImage(thumb, i)" 
                            title="Delete image">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </button>
                  </div>
                </div>
                <p class="upload-status">‚úÖ {{uploadedImageThumbnails.length}} images ready for training</p>
              </div>
              
              <!-- Selected files preview (active work) -->
              <div class="selected-files-preview active-work-area" *ngIf="selectedFilesWithQuality.length > 0">
                <div class="section-header">
                  <h4>üìã Review Selected Images ({{selectedFilesWithQuality.length}})</h4>
                  <p class="section-subtitle">Check quality scores and fix any issues before uploading</p>
                </div>
                <div class="selected-files-grid-enhanced">
                  <div class="selected-file-item-enhanced" 
                       *ngFor="let fileData of selectedFilesWithQuality; index as i"
                       [class.file-valid]="fileData.isValid"
                       [class.file-invalid]="!fileData.isValid">
                    <img [src]="getFilePreview(fileData.file)" alt="Preview">
                    
                    <!-- Quality Score Header - Clean, minimal design -->
                    <div class="file-status-header">
                      <!-- Quality Score Badge Only -->
                      <div class="quality-badge" *ngIf="fileData.qualityScore">
                        <span class="quality-score-compact" 
                              [class.score-red]="fileData.qualityScore.overall < 50"
                              [class.score-yellow]="fileData.qualityScore.overall >= 50 && fileData.qualityScore.overall < 75"
                              [class.score-green]="fileData.qualityScore.overall >= 75">
                          {{fileData.qualityScore.overall}}
                        </span>
                      </div>
                    </div>
                    
                    <div class="file-info-enhanced">
                      <span class="file-name">{{fileData.file.name}}</span>
                      
                      <!-- Clean quality summary -->
                      <div class="file-quality-summary" *ngIf="fileData.qualityScore || fileData.faceValidation">
                        <div class="summary-item" *ngIf="fileData.faceValidation">
                          <span class="summary-label">{{fileData.faceValidation.faceCount}} face(s) detected</span>
                          <span class="summary-value">{{fileData.faceValidation.bodyType | titlecase}}</span>
                        </div>
                        <div class="summary-item" *ngIf="fileData.warnings && fileData.warnings.length > 0">
                          <span class="warning-count">{{fileData.warnings.length}} warning(s)</span>
                        </div>
                        <div class="summary-item" *ngIf="fileData.errors && fileData.errors.length > 0">
                          <span class="error-count">{{fileData.errors.length}} error(s)</span>
                        </div>
                      </div>
                      
                    </div>
                    
                    <!-- Info Button for Invalid Files -->
                    <div class="file-info-popup" *ngIf="!fileData.isValid">
                      <button class="info-btn" 
                              (click)="fileData.showDetails = !fileData.showDetails"
                              [class.active]="fileData.showDetails"
                              type="button">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                          <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                          <path d="M12 16V12M12 8h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                      </button>
                      
                      <!-- Popup Notification -->
                      <div class="popup-details" 
                           *ngIf="fileData.showDetails"
                           (click)="$event.stopPropagation()">
                        <div class="popup-arrow"></div>
                        <div class="popup-content">
                          <!-- Errors Section -->
                          <div class="popup-section" *ngIf="fileData.errors && fileData.errors.length > 0">
                            <h6 class="popup-title">‚ùå Issues</h6>
                            <ul class="popup-list">
                              <li *ngFor="let error of fileData.errors">{{error}}</li>
                            </ul>
                          </div>
                          
                          <!-- Warnings Section -->
                          <div class="popup-section" *ngIf="fileData.warnings && fileData.warnings.length > 0">
                            <h6 class="popup-title">‚ö†Ô∏è Warnings</h6>
                            <ul class="popup-list">
                              <li *ngFor="let warning of fileData.warnings">{{warning}}</li>
                            </ul>
                          </div>
                          
                          <!-- Quick Fix -->
                          <div class="popup-fix" *ngIf="fileData.qualityScore && fileData.qualityScore.suggestions && fileData.qualityScore.suggestions.length > 0">
                            üí° {{fileData.qualityScore.suggestions[0]}}
                          </div>
                        </div>
                      </div>
                    </div>
                    
                    <button class="remove-file-btn" (click)="removeFile(i)" title="Remove file">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </button>
                  </div>
                </div>
                
                <!-- Upload Summary with Add More Button -->
                <div class="upload-summary-enhanced" *ngIf="selectedFilesWithQuality.length > 0">
                  <div class="summary-stats">
                    <span class="stat-item valid" *ngIf="getValidFilesCount() > 0">
                      ‚úì {{getValidFilesCount()}} ready to upload
                    </span>
                    <span class="stat-item invalid" *ngIf="getInvalidFilesCount() > 0">
                      ‚úó {{getInvalidFilesCount()}} need attention
                    </span>
                    <!-- Add More Button in Summary -->
                    <button class="btn btn-secondary add-more-inline-btn" 
                            *ngIf="selectedFilesWithQuality.length > 0 && !isUploading && !isCheckingQuality"
                            (click)="triggerFileUpload()">
                      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" style="margin-right: 6px;">
                        <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                      Add More
                    </button>
                  </div>
                </div>
              </div>
              
              <!-- Unified Upload Actions Section -->
              <div class="upload-actions-container">
                <!-- Quality Check Progress -->
                <div class="quality-check-progress" *ngIf="isCheckingQuality">
                  <div class="progress-bar">
                    <div class="progress-fill indeterminate"></div>
                  </div>
                  <p class="progress-text">{{qualityCheckProgress}}</p>
                </div>

                <!-- Primary Upload Button Only -->
                <div class="upload-actions-row" *ngIf="!isCheckingQuality && getValidFilesCount() > 0">
                  <button class="btn btn-primary upload-primary-btn" 
                          (click)="uploadImages()"
                          [disabled]="isUploading || getValidFilesCount() === 0">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="margin-right: 8px;" *ngIf="!isUploading">
                      <path d="M14 2H6C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V8L14 2Z" stroke="currentColor" stroke-width="2"/>
                      <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2"/>
                      <path d="M12 11V17M9 14L12 11L15 14" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <div class="spinner" *ngIf="isUploading" style="margin-right: 8px; width: 16px; height: 16px;"></div>
                    <span *ngIf="isUploading">Uploading... {{uploadProgress}}%</span>
                    <span *ngIf="!isUploading">Upload {{getValidFilesCount()}} Image{{getValidFilesCount() !== 1 ? 's' : ''}}</span>
                  </button>
                </div>
              </div>


              <!-- Upload Progress Bar -->
              <div class="upload-progress" *ngIf="isUploading">
                <div class="progress-bar">
                  <div class="progress-fill" [style.width.%]="uploadProgress"></div>
                </div>
                <p class="progress-text">{{uploadProgress}}% uploaded</p>
              </div>

            </div>
          </div>

          <!-- Step 2: Generate Images -->
          <div class="step-card" [class.completed]="generatedPhotos.length > 0" [class.active]="currentStep === 2">
            <div class="step-header">
              <div class="step-number">2</div>
              <div class="step-title">
                <h3>Generate Your Professional Photos</h3>
                <p *ngIf="modelStatus !== 'trained'">Select styles and we'll train your model then generate photos</p>
                <p *ngIf="modelStatus === 'trained'">Select styles to generate photos with your trained model</p>
              </div>
              <div class="step-status">
                <span class="status-badge" [ngClass]="getStepStatus(2)">
                  {{getStepStatusText(2)}}
                </span>
              </div>
            </div>
            <div class="step-content" *ngIf="uploadedImages > 0 || uploadedImageThumbnails.length > 0">
              <!-- Style Selector Component -->
              <app-style-selector
                [availableStyles]="availableStyles"
                [imagesPerStyle]="imagesPerStyle"
                [selectedStyles]="selectedStyles"
                [trainingCredits]="calculateTrainingCredits()"
                [generationCredits]="calculateGenerationCredits()"
                [totalCredits]="calculateTotalCredits()"
                [hasEnoughCredits]="hasEnoughCredits()"
                [remainingCredits]="getRemainingCredits()"
                [isTrainingStarted]="isTrainingStarted"
                [modelStatus]="modelStatus"
                [uploadedImageCount]="uploadedImageThumbnails.length"
                (styleToggled)="onStyleToggled($event)"
                (imagesPerStyleChanged)="onImagesPerStyleChanged($event)"
                (selectAllStyles)="onSelectAllStyles()"
                (deselectAllStyles)="onDeselectAllStyles()"
                (startTraining)="onStartTraining()">
              </app-style-selector>
              
              <!-- Training Progress (only shown when actively training) -->
              <div class="training-progress-section" *ngIf="modelStatus === 'training'">
                <div class="training-progress">
                  <div class="progress-circle">
                    <div class="progress-text">{{trainingProgress}}%</div>
                  </div>
                  <div class="training-info">
                    <h4>üöÄ Training Your AI Model</h4>
                    <p>This usually takes 15-25 minutes. You'll be notified when it's complete!</p>
                    <p class="eta">Estimated completion: {{estimatedCompletion}}</p>
                    <div class="model-retention-info">
                      <small class="text-muted">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" style="margin-right: 4px;">
                          <path d="M12 2L2 7v10c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7L12 2z" stroke="currentColor" stroke-width="2" fill="none"/>
                        </svg>
                        Your training photos will be deleted after 7 days. Generated images stored for 30 days.
                      </small>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Generation Progress (only shown when actively generating) -->
              <div class="generation-progress-section" *ngIf="isGenerating">
                <div class="progress-indicator">
                  <div class="spinner"></div>
                  <h4>üé® Generating Your Photos</h4>
                  <p>Creating professional photos with your selected styles...</p>
                  <p class="progress-detail">This usually takes 2-5 minutes per style</p>
                </div>
              </div>
              
              <!-- Generated Photos Results -->
              <div class="generated-results" *ngIf="generatedPhotos.length > 0">
                <h4>üéâ Your Professional Photos Are Ready!</h4>
                <div class="retention-warning">
                  <div class="alert alert-info">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="margin-right: 8px;">
                      <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                      <path d="M12 8v4l3 3" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <strong>Data Retention:</strong> Your AI headshots will be stored for <strong>30 days</strong> for easy access and downloads. 
                    You can delete your data anytime via account settings.
                  </div>
                </div>
                <div class="results-grid">
                  <div class="result-card" *ngFor="let photo of generatedPhotos">
                    <img [src]="photo.url" [alt]="photo.style" (error)="onImageError($event)">
                    <div class="result-overlay">
                      <h4>{{photo.style}}</h4>
                      <div class="result-actions">
                        <button class="btn btn-sm btn-download" (click)="downloadPhoto(photo)">
                          Download
                        </button>
                        <button class="btn btn-sm btn-share" (click)="sharePhoto(photo)">
                          Share
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="bulk-actions" *ngIf="generatedPhotos.length > 1">
                  <button class="btn btn-primary" (click)="downloadAll()" [disabled]="isDownloadingZip">
                    <div class="spinner" *ngIf="isDownloadingZip" style="margin-right: 8px; width: 16px; height: 16px;"></div>
                    <svg *ngIf="!isDownloadingZip" width="16" height="16" viewBox="0 0 24 24" fill="none" style="margin-right: 8px;">
                      <path d="M14 2H6C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" fill="none"/>
                      <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2"/>
                      <path d="M12 18L8 14M12 18L16 14M12 18V11" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <span *ngIf="isDownloadingZip">Creating ZIP...</span>
                    <span *ngIf="!isDownloadingZip">Download All as ZIP ({{generatedPhotos.length}} photos)</span>
                  </button>
                </div>
                <div class="view-gallery-action">
                  <button class="btn btn-secondary" routerLink="/gallery">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                      <rect x="3" y="3" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                      <circle cx="8.5" cy="8.5" r="1.5" stroke="currentColor" stroke-width="2"/>
                      <polyline points="21,15 16,10 5,21" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    View All Photos in Gallery
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Step 3: View Generated Photos -->
          <div class="step-card" [class.completed]="generatedPhotos.length > 0" [class.active]="getStepStatus(3) === 'active'">
            <div class="step-header">
              <div class="step-number">3</div>
              <div class="step-title">
                <h3>View Your Professional Photos</h3>
                <p>Download and share your AI-generated professional photos</p>
              </div>
              <div class="step-status">
                <span class="status-badge" [ngClass]="getStepStatus(3)">
                  {{getStepStatusText(3)}}
                </span>
              </div>
            </div>
            <div class="step-content" *ngIf="generatedPhotos.length > 0">
              <div class="completion-message">
                <div class="success-icon">üéâ</div>
                <h4>Congratulations! Your photos are ready</h4>
                <p>Your AI model has successfully generated {{generatedPhotos.length}} professional photos.</p>
              </div>
              
              <div class="quick-actions">
                <button class="btn btn-primary" (click)="downloadAll()" [disabled]="isDownloadingZip">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="margin-right: 8px;">
                    <path d="M14 2H6C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" fill="none"/>
                    <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2"/>
                    <path d="M12 18L8 14M12 18L16 14M12 18V11" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  <span *ngIf="isDownloadingZip">Creating ZIP...</span>
                  <span *ngIf="!isDownloadingZip">Download All ({{generatedPhotos.length}} photos)</span>
                </button>
                
                <button class="btn btn-secondary" routerLink="/gallery">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="margin-right: 8px;">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                    <circle cx="8.5" cy="8.5" r="1.5" stroke="currentColor" stroke-width="2"/>
                    <polyline points="21,15 16,10 5,21" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  View in Gallery
                </button>
              </div>

              <div class="photo-preview-grid">
                <div class="preview-photo" *ngFor="let photo of generatedPhotos.slice(0, 6)">
                  <img [src]="photo.url" [alt]="photo.style + ' style'" (error)="onImageError($event)">
                  <div class="photo-overlay">
                    <span class="style-name">{{photo.style}}</span>
                    <button class="btn-download" (click)="downloadPhoto(photo)" title="Download">
                      ‚¨áÔ∏è
                    </button>
                  </div>
                </div>
              </div>

              <div class="next-steps" *ngIf="generatedPhotos.length > 6">
                <p>+ {{generatedPhotos.length - 6}} more photos in your gallery</p>
              </div>
            </div>
          </div>

        </div>
      </section>



    </div>
  </main>
</div>
